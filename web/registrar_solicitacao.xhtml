<?xml version='1.0' encoding='UTF-8' ?>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Projeto de extensão</title>
        <meta name="if-sul" content="projeto"></meta>
        <h:outputStylesheet library="css" name="registarSolicitacao.css" />
        <script src="resources/javascript/scripts.js" type="text/javascript"></script>
        <script src="resources/javascript/googleMaps.js" type="text/javascript"></script>
        <script src="//maps.googleapis.com/maps/api/js?key=AIzaSyCDeDTdxDcvnRufBvILmxZUgD3U947b9t4" async="" defer="defer" type="text/javascript"></script>
        <script src="http://www.google.com/jsapi" type="text/javascript"></script>
    </h:head>
    <h:body style="background-image: url('resources/imagens/bage_aerea.jpg'); background-size: 100% 100%;background-attachment: fixed;background-position: center;background-repeat: no-repeat;">
        <ui:include src="header.xhtml"/>
        <b:container id="container">
            <b:form id="formularios" horizontal="true" enctype="multipart/form-data">
                <b:container class="confirmacao" rendered="#{registarSolicitacaoMB.confirmacao}" style="width: 90%;margin-left: 4%">
                    <h:outputText value="#{registarSolicitacaoMB.solicitacao.descricao}" style="color: blue;text-align: center;margin-bottom: 1%;width: 100%"/><br/>
                    <p:graphicImage value="#{registarSolicitacaoMB.image}" alt=" erro ao carregar imagem " cache="false"
                                    style="width: 80%;height: 40%;margin: 3% 0 3% 10%;max-height: 350px"/>
                    <b:commandButton id="botao_confirmar" value="Confirmar" style="width: 70%;float: bottom;position: relative;height: 50px;margin: 4% 0 0 15%;background-color: blue;color: white" action="#{registarSolicitacaoMB.concluir()}"/>
                    <b:commandButton id="botao_cancelar" value="Cancelar" style="width: 70%;float: bottom;position: relative;height: 50px;margin: 3% 0 4% 15%;background-color: darkorange;color: white" action="#{registarSolicitacaoMB.cancelar()}"/>
                </b:container>
                <h1 class="titulo">Prefeitura municipal de Bagé a serviço da população</h1>
                <b:container class="form_servico" style="width: 90%;">
                    <h3 class="subtitulo">Descrição do servico</h3>
                    <h:outputText value="Adicionar foto" style="color: chocolate;float: left;position: relative;font-size: 15px;margin-left: 3%"/>
                    <p:growl id="messages3" showDetail="true" />
                    <p:fileUpload value="#{registarSolicitacaoMB.file}" class="file_upload"
                                  cancelLabel="Cancelar" label="Escolher foto" uploadLabel="Upload"
                                  fileUploadListener="#{registarSolicitacaoMB.upload}"
                                  invalidFileMessage="Somente arquivos .jpg, .png ou .gif"
                                  allowTypes="/(\.|\/)(gif|jpe?g|png)$/" dragDropSupport="true"
                                  mode="advanced" skinSimple="true" update="imagem" required="true"
                                  sizeLimit="10000000" invalidSizeMessage="Tamanho maximo da imagem : 1mb"/>
                    <p:graphicImage id="imagem" value="#{registarSolicitacaoMB.image}" alt=" " cache="false"
                                    style="width: 80%;height: 10%;margin: 1% 0 3% 10%;max-height: 350px"/>
                    <b:inputTextarea class="input_descricao" label-style="text-align : left;margin-top: 10px;color: chocolate;min-width: 100px;margin-left: 4%" style="margin: auto;height: 180px;margin-bottom: 5%;width: 90%;margin-left: 5%"
                                     value="#{registarSolicitacaoMB.solicitacao.descricao}" label="Descrição" tooltip="descrição do serviço" required="true" validatorMessage="A descrição é de preenchimento obrigatorio!">
                        <f:validateLength minimum="10" maximum="400"/>
                    </b:inputTextarea>
                    <p:growl id="messages" showDetail="true" />
                    <h:outputText value="Adicionar localização" style="width: 100%;color: chocolate;font-size: 16px;margin: 40% 0 1% 1%"/>
                    <p:gmap id="gmap" center="-31.334046274414,-54.10234451293945" zoom="15" type="HYBRID" style="width:100%;height:300px;margin:3% 0 7% 0"
                            model="#{registarSolicitacaoMB.mapa}" onPointClick="handlePointClick(event);" widgetVar="map">
                        <p:ajax event="markerDrag" listener="#{registarSolicitacaoMB.onMarkerDrag(event)}"/>
                        <!--p:ajax event="pointSelect" listener=""/-->
                    </p:gmap>
                </b:container>
                <b:container class="form_informacoes_pessoais" style="width: 90%">
                    <h3 class="subtitulo">Minhas informações</h3>
                    <b:inputText label-style="text-align : right;color: chocolate;margin-top:1%" class="form_informacoes_input" label-small-screen="2" small-screen="9" required="true" 
                                 label="Email" value="#{registarSolicitacaoMB.requerente.email}" tooltip="email" validatorMessage="O campo email dever ser inserido corretamente!">
                        <f:validateRegex pattern="[\w\.-]*[a-zA-Z0-9_]@[\w\.-]*[a-zA-Z0-9]\.[a-zA-Z][a-zA-Z\.]*[a-zA-Z]" />
                    </b:inputText>
                    <b:inputText label-style="text-align : right;color: chocolate;margin-top:1%" class="form_informacoes_input" label-small-screen="2" small-screen="9" required="true"
                                 label="Nome" value="#{registarSolicitacaoMB.requerente.nome}" tooltip="nome" onkeypress="mascara(this, soLetras)" validatorMessage="O campo nome deve ser preenchido!">
                        <f:validateLength minimum="5" maximum="100" />
                    </b:inputText>
                    <b:inputText label-style="text-align : right;color: chocolate;margin-top:1%" class="form_informacoes_input" label-small-screen="2" small-screen="9"   required="true"
                                 label="Celular" value="#{registarSolicitacaoMB.requerente.celular}" tooltip="celular" onkeypress="mascara(this, soNumeros)" validatorMessage="O campo celular deve ser preenchido corretamente!">
                        <f:validateLength minimum="11" maximum="15" />
                    </b:inputText>
                    <b:dateTimePicker label-style="text-align : right;color: chocolate;margin:1% 0 2% 0" class="form_informacoes_input" label-small-screen="2" small-screen="9"
                                      onkeypress="mascaraData(this)" label="Data de nascimento" value="#{registarSolicitacaoMB.requerente.dataNasc}" tooltip="data de nascimento" 
                                      mode="toggle-icon" show-time="false" initialDate="10/10/1990" format="DD/MM/YYYY" required="true">
                    </b:dateTimePicker>
                    <b:selectBooleanCheckbox value="#{registarSolicitacaoMB.solicitacao.anonimo}" label="Anônimo" 
                                             label-style="text-align : right;color: chocolate;margin:0 0 2% 0"  
                                             style="margin-bottom: 4rem" label-small-screen="2" small-screen="3"/>
                </b:container>
                <h:commandButton class="continuar" value="continuar" action="#{registarSolicitacaoMB.continuar()}" actionListener="#{registarSolicitacaoMB.continuar()}"
                                 style="width: 70%;margin: 7% 0 5% 15%;background-color: blue;color: white;height: 50px;text-align: center;font-size: 18px;border-radius: 8px"/>
            </b:form>
        </b:container>
        <p:dialog widgetVar="dlg" showEffect="fade">
            <h:form prependId="false">
                <h:panelGrid columns="2">
                    <h:outputLabel for="title" value="Confirmação" style="text-align: center"/>
                    <h:inputHidden id="title" value="#{registarSolicitacaoMB.localizacao.titulo}"/>
                    <f:facet name="footer">
                        <p:commandButton value="Continuar" onclick="adicionarMarcador()"/>
                        <p:commandButton value="Cancel" onclick="return cancelar()"/>
                    </f:facet>
                </h:panelGrid>
                <h:inputHidden id="lat" value="#{registarSolicitacaoMB.localizacao.latitude}"/>
                <h:inputHidden id="lng" value="#{registarSolicitacaoMB.localizacao.longitude}"/>
            </h:form>
        </p:dialog>
    </h:body>
</html>


